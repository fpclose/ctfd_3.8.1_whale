# FRP Client 配置模板
# 版本: 0.52.3
# 用途: 在 Docker 容器中运行的 FRP Client

[common]
# FRP Server 地址
# Docker 容器中使用 host.docker.internal 访问宿主机
# CHANGE_ME: 如果 FRP Server 在其他服务器，修改为实际 IP
server_addr = host.docker.internal

# FRP Server 端口（需与 frps.ini 中的 bind_port 一致）
server_port = 7897

# 认证令牌（必须与 frps.ini 中的 token 完全一致）
# CHANGE_ME: 与 frps.ini 保持同步
token = your_secure_token_here

# Admin API 配置（用于 Whale 插件管理 FRP）
# 监听地址（容器内部）
admin_addr = 0.0.0.0
# Admin API 端口
admin_port = 7400
# Admin 用户名（可选）
# admin_user = admin
# Admin 密码（可选）
# admin_pwd = admin

# 日志配置
# 容器中输出到标准输出
log_file = /dev/stdout
log_level = info

# ========== 可选配置 ==========

# 用户名（区分不同的 FRP Client，可选）
# user = ctfd_whale

# 心跳配置
heartbeat_interval = 30
heartbeat_timeout = 90

# TCP 多路复用
tcp_mux = true

# 连接池大小
pool_count = 5

# ========== 静态代理配置（可选） ==========

# 如果需要静态代理，可以在这里添加
# 但 Whale 插件通过 Admin API 动态管理代理，通常不需要静态配置

# 示例 - HTTP 代理
# [web_service]
# type = http
# local_ip = 172.17.0.1
# local_port = 8080
# subdomain = web
# custom_domains = web.example.com

# 示例 - TCP 代理
# [ssh_service]
# type = tcp
# local_ip = 127.0.0.1
# local_port = 22
# remote_port = 6000

# 配置说明:
# 
# 1. Admin API
#    Whale 插件通过 Admin API 动态创建和删除代理
#    URL: http://172.19.0.10:7400 (Docker 内网 IP)
#    
#    API 端点:
#    - GET  /api/status          # 查看代理状态
#    - GET  /api/config          # 查看配置
#    - PUT  /api/config          # 更新配置（重新加载）
#    - POST /api/reload          # 重新加载配置
# 
# 2. 动态代理工作流程
#    用户启动容器 → Whale 创建容器 → 调用 FRP Admin API 添加代理
#    → FRP Client 创建隧道 → 用户可访问题目
#    
#    用户销毁容器 → Whale 销毁容器 → 调用 FRP Admin API 删除代理
#    → FRP Client 关闭隧道
# 
# 3. HTTP 代理格式
#    Whale 自动生成:
#    [<uuid>]
#    type = http
#    local_ip = <container_ip>
#    local_port = <container_port>
#    subdomain = <uuid>
#    
#    访问: http://<uuid>.<subdomain_host>:<vhost_http_port>
# 
# 4. TCP 代理格式
#    Whale 自动生成:
#    [<uuid>]
#    type = tcp
#    local_ip = <container_ip>
#    local_port = <container_port>
#    remote_port = <allocated_port>
#    
#    访问: nc <server_ip> <allocated_port>

# 注意事项:
# 1. token 必须与 frps.ini 完全一致
# 2. server_addr 在容器中使用 host.docker.internal
# 3. admin_addr 必须是 0.0.0.0 (监听所有接口)
# 4. 不要在此文件中添加静态代理配置（Whale 会动态管理）
# 5. 确保 frpc.ini 挂载为可读写模式（不加 :ro）

